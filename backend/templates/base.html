<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SubMatch - Discover Subreddits</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <script src="https://kit.fontawesome.com/f4e5dcf0e0.js" crossorigin="anonymous"></script>
</head>

<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <img src="/static/images/logo.png" alt="SubMatch Logo" class="logo">
                <h1 class="header-title">SubMatch</h1>
            </div>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <h2 class="hero-title">Discover Subreddits</h2>
                <form id="subreddit-form" class="subreddit-form">
                    <input class="keyword-input" placeholder="Enter three keywords (comma-separated)" name="keywords"
                        required>
                    <button type="submit" class="find-button">Find</button>
                </form>
            </div>
        </section>

        <section class="results">
            <div class="container">
                <div id="answer-box" class="answer-box"></div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('subreddit-form');
            const answerBox = document.getElementById('answer-box');

            form.addEventListener('submit', (event) => {
                event.preventDefault();

                const formData = new FormData(form);
                const keywords = formData.get('keywords');

                fetch(`/recommend?query=${encodeURIComponent(keywords)}`)
                    .then(response => response.json())
                    .then(data => {
                        answerBox.innerHTML = ''; // Clear previous results

                        if (data.length === 0) {
                            const message = document.createElement('p');
                            message.textContent = 'Please input more information.';
                            answerBox.appendChild(message);
                        } else {
                            const resultsList = document.createElement('ul');
                            resultsList.className = 'results-list';

                            data.forEach(subreddit => {
                                const listItem = document.createElement('li');
                                listItem.className = 'result-item';

                                const subredditLink = document.createElement('a');
                                subredditLink.href = `https://www.reddit.com/r/${subreddit}`;
                                subredditLink.target = '_blank';
                                subredditLink.textContent = `r/${subreddit}`;

                                listItem.appendChild(subredditLink);
                                resultsList.appendChild(listItem);
                            });

                            answerBox.appendChild(resultsList);
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        const errorMessage = document.createElement('p');
                        errorMessage.textContent = 'An error occurred while fetching subreddits.';
                        answerBox.appendChild(errorMessage);
                    });
            });
        });
    </script>
</body>

</html>